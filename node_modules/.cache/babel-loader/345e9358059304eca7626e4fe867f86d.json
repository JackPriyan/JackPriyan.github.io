{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Jakith\\\\JackPriyan.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Jakith\\\\JackPriyan.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Jakith\\\\JackPriyan.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import Footer from'./footer';import Level from'./level';import MapExplorer from'./mapexplorer';import Minigraph from'./minigraph';import Search from'./search';import Table from'./table';import TimeSeriesExplorer from'./timeseriesexplorer';import Updates from'./updates';import{STATE_CODES_REVERSE}from'../constants';import{formatDate,formatDateAbsolute,mergeTimeseries,preprocessTimeseries,parseStateTimeseries,parseStateTestData,parseStateTestTimeseries,parseTotalTestTimeseries,parseDistrictZones}from'../utils/commonfunctions';import axios from'axios';import React,{useState,useCallback,useMemo}from'react';import*as Icon from'react-feather';import{Helmet}from'react-helmet';import{useEffectOnce,useLocalStorage}from'react-use';function Home(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),states=_useState2[0],setStates=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),stateDistrictWiseData=_useState4[0],setStateDistrictWiseData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),districtZones=_useState6[0],setDistrictZones=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),stateTestData=_useState8[0],setStateTestData=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),lastUpdated=_useState10[0],setLastUpdated=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),timeseries=_useState12[0],setTimeseries=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),fetched=_useState14[0],setFetched=_useState14[1];var _useState15=useState({state:'Total'}),_useState16=_slicedToArray(_useState15,2),regionHighlighted=_useState16[0],setRegionHighlighted=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),showUpdates=_useState18[0],setShowUpdates=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),anchor=_useState20[0],setAnchor=_useState20[1];var _useState21=useState('confirmed'),_useState22=_slicedToArray(_useState21,2),mapOption=_useState22[0],setMapOption=_useState22[1];var _useLocalStorage=useLocalStorage('lastViewedLog',null),_useLocalStorage2=_slicedToArray(_useLocalStorage,2),lastViewedLog=_useLocalStorage2[0],setLastViewedLog=_useLocalStorage2[1];var _useLocalStorage3=useLocalStorage('newUpdate',false),_useLocalStorage4=_slicedToArray(_useLocalStorage3,2),newUpdate=_useLocalStorage4[0],setNewUpdate=_useLocalStorage4[1];var Bell=useMemo(function(){return/*#__PURE__*/React.createElement(Icon.Bell,{onClick:function onClick(){setShowUpdates(!showUpdates);setNewUpdate(false);}});},[setNewUpdate,showUpdates]);var BellOff=useMemo(function(){return/*#__PURE__*/React.createElement(Icon.BellOff,{onClick:function onClick(){setShowUpdates(!showUpdates);}});},[showUpdates]);useEffectOnce(function(){getStates();});useEffectOnce(function(){axios.get('https://api.covid19india.org/updatelog/log.json').then(function(response){var lastTimestamp=response.data.slice().reverse()[0].timestamp.toString();if(lastTimestamp!==lastViewedLog){setNewUpdate(true);setLastViewedLog(lastTimestamp);}}).catch(function(err){console.log(err);});});var getStates=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,statesDailyResponse,zonesResponse,_yield$Promise$all3,_yield$Promise$all4,data,stateDistrictWiseResponse,_stateTestData,ts,testTs,tsMerged,testData,totalTest;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([axios.get('https://api.covid19india.org/states_daily.json'),axios.get('https://api.covid19india.org/zones.json')]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);statesDailyResponse=_yield$Promise$all2[0].data;zonesResponse=_yield$Promise$all2[1].data;_context.next=9;return Promise.all([axios.get('https://api.covid19india.org/data.json'),axios.get('https://api.covid19india.org/state_district_wise.json'),axios.get('https://api.covid19india.org/state_test_data.json')]);case 9:_yield$Promise$all3=_context.sent;_yield$Promise$all4=_slicedToArray(_yield$Promise$all3,3);data=_yield$Promise$all4[0].data;stateDistrictWiseResponse=_yield$Promise$all4[1].data;_stateTestData=_yield$Promise$all4[2].data;setStates(data.statewise);setDistrictZones(parseDistrictZones(zonesResponse.zones));ts=parseStateTimeseries(statesDailyResponse);ts['TT']=preprocessTimeseries(data.cases_time_series);// Testing data timeseries\ntestTs=parseStateTestTimeseries(_stateTestData.states_tested_data);testTs['TT']=parseTotalTestTimeseries(data.tested);// Merge\ntsMerged=mergeTimeseries(ts,testTs);setTimeseries(tsMerged);setLastUpdated(data.statewise[0].lastupdatedtime);testData=parseStateTestData(_stateTestData.states_tested_data);totalTest=data.tested[data.tested.length-1];testData['Total']={source:totalTest.source,totaltested:totalTest.totalsamplestested,updatedon:totalTest.updatetimestamp.split(' ')[0]};setStateTestData(testData);setStateDistrictWiseData(stateDistrictWiseResponse);setFetched(true);_context.next=34;break;case 31:_context.prev=31;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 34:case\"end\":return _context.stop();}}},_callee,null,[[0,31]]);}));return function getStates(){return _ref.apply(this,arguments);};}();var onHighlightState=useCallback(function(state){if(!state)return setRegionHighlighted(null);setRegionHighlighted({state:state.state});},[]);var onHighlightDistrict=useCallback(function(district,state){if(!state&&!district)return setRegionHighlighted(null);setRegionHighlighted({district:district,state:state.state});},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"Home\"},/*#__PURE__*/React.createElement(Helmet,null,/*#__PURE__*/React.createElement(\"title\",null,\"Coronavirus Outbreak in India - covid19india.org\"),/*#__PURE__*/React.createElement(\"meta\",{name:\"title\",content:\"Coronavirus Outbreak in India: Latest Map and Case Count\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"home-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"header fadeInUp\",style:{animationDelay:'1s'}},fetched&&/*#__PURE__*/React.createElement(Search,{districtZones:districtZones}),/*#__PURE__*/React.createElement(\"div\",{className:\"actions\"},/*#__PURE__*/React.createElement(\"h5\",null,isNaN(Date.parse(formatDate(lastUpdated)))?'':\"\".concat(formatDateAbsolute(lastUpdated),\" IST\")),fetched&&!showUpdates&&/*#__PURE__*/React.createElement(\"div\",{className:\"bell-icon\"},fetched&&Bell,newUpdate&&/*#__PURE__*/React.createElement(\"div\",{className:\"indicator\"})),fetched&&showUpdates&&BellOff)),showUpdates&&/*#__PURE__*/React.createElement(Updates,null),states&&/*#__PURE__*/React.createElement(Level,{data:states[0]}),timeseries&&/*#__PURE__*/React.createElement(Minigraph,{timeseries:timeseries['TT']}),stateDistrictWiseData&&/*#__PURE__*/React.createElement(Table,{states:states,summary:false,districts:stateDistrictWiseData,zones:districtZones,regionHighlighted:regionHighlighted,setRegionHighlighted:setRegionHighlighted,onHighlightState:onHighlightState,onHighlightDistrict:onHighlightDistrict})),/*#__PURE__*/React.createElement(\"div\",{className:\"home-right\"},/*#__PURE__*/React.createElement(React.Fragment,null,fetched&&/*#__PURE__*/React.createElement(MapExplorer,{mapName:'India',states:states,districts:stateDistrictWiseData,zones:districtZones,stateTestData:stateTestData,regionHighlighted:regionHighlighted,setRegionHighlighted:setRegionHighlighted,anchor:anchor,setAnchor:setAnchor,mapOption:mapOption,setMapOption:setMapOption}),timeseries&&/*#__PURE__*/React.createElement(TimeSeriesExplorer,{timeseries:timeseries[STATE_CODES_REVERSE[regionHighlighted===null||regionHighlighted===void 0?void 0:regionHighlighted.state]||'TT'],activeStateCode:STATE_CODES_REVERSE[regionHighlighted===null||regionHighlighted===void 0?void 0:regionHighlighted.state]||'TT',onHighlightState:onHighlightState,states:states,anchor:anchor,setAnchor:setAnchor})))),fetched&&/*#__PURE__*/React.createElement(Footer,null));}export default Home;","map":{"version":3,"sources":["C:/Users/Jakith/JackPriyan.github.io/src/components/home.js"],"names":["Footer","Level","MapExplorer","Minigraph","Search","Table","TimeSeriesExplorer","Updates","STATE_CODES_REVERSE","formatDate","formatDateAbsolute","mergeTimeseries","preprocessTimeseries","parseStateTimeseries","parseStateTestData","parseStateTestTimeseries","parseTotalTestTimeseries","parseDistrictZones","axios","React","useState","useCallback","useMemo","Icon","Helmet","useEffectOnce","useLocalStorage","Home","props","states","setStates","stateDistrictWiseData","setStateDistrictWiseData","districtZones","setDistrictZones","stateTestData","setStateTestData","lastUpdated","setLastUpdated","timeseries","setTimeseries","fetched","setFetched","state","regionHighlighted","setRegionHighlighted","showUpdates","setShowUpdates","anchor","setAnchor","mapOption","setMapOption","lastViewedLog","setLastViewedLog","newUpdate","setNewUpdate","Bell","BellOff","getStates","get","then","response","lastTimestamp","data","slice","reverse","timestamp","toString","catch","err","console","log","Promise","all","statesDailyResponse","zonesResponse","stateDistrictWiseResponse","statewise","zones","ts","cases_time_series","testTs","states_tested_data","tested","tsMerged","lastupdatedtime","testData","totalTest","length","source","totaltested","totalsamplestested","updatedon","updatetimestamp","split","onHighlightState","onHighlightDistrict","district","animationDelay","isNaN","Date","parse"],"mappings":"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","sourcesContent":["import Footer from './footer';\r\nimport Level from './level';\r\nimport MapExplorer from './mapexplorer';\r\nimport Minigraph from './minigraph';\r\nimport Search from './search';\r\nimport Table from './table';\r\nimport TimeSeriesExplorer from './timeseriesexplorer';\r\nimport Updates from './updates';\r\n\r\nimport {STATE_CODES_REVERSE} from '../constants';\r\nimport {\r\n  formatDate,\r\n  formatDateAbsolute,\r\n  mergeTimeseries,\r\n  preprocessTimeseries,\r\n  parseStateTimeseries,\r\n  parseStateTestData,\r\n  parseStateTestTimeseries,\r\n  parseTotalTestTimeseries,\r\n  parseDistrictZones,\r\n} from '../utils/commonfunctions';\r\n\r\nimport axios from 'axios';\r\nimport React, {useState, useCallback, useMemo} from 'react';\r\nimport * as Icon from 'react-feather';\r\nimport {Helmet} from 'react-helmet';\r\nimport {useEffectOnce, useLocalStorage} from 'react-use';\r\nfunction Home(props) {\r\n  const [states, setStates] = useState(null);\r\n  const [stateDistrictWiseData, setStateDistrictWiseData] = useState(null);\r\n  const [districtZones, setDistrictZones] = useState(null);\r\n  const [stateTestData, setStateTestData] = useState(null);\r\n  const [lastUpdated, setLastUpdated] = useState('');\r\n  const [timeseries, setTimeseries] = useState(null);\r\n  const [fetched, setFetched] = useState(false);\r\n  const [regionHighlighted, setRegionHighlighted] = useState({\r\n    state: 'Total',\r\n  });\r\n  const [showUpdates, setShowUpdates] = useState(false);\r\n  const [anchor, setAnchor] = useState(null);\r\n  const [mapOption, setMapOption] = useState('confirmed');\r\n\r\n  const [lastViewedLog, setLastViewedLog] = useLocalStorage(\r\n    'lastViewedLog',\r\n    null\r\n  );\r\n  const [newUpdate, setNewUpdate] = useLocalStorage('newUpdate', false);\r\n\r\n  const Bell = useMemo(\r\n    () => (\r\n      <Icon.Bell\r\n        onClick={() => {\r\n          setShowUpdates(!showUpdates);\r\n          setNewUpdate(false);\r\n        }}\r\n      />\r\n    ),\r\n    [setNewUpdate, showUpdates]\r\n  );\r\n\r\n  const BellOff = useMemo(\r\n    () => (\r\n      <Icon.BellOff\r\n        onClick={() => {\r\n          setShowUpdates(!showUpdates);\r\n        }}\r\n      />\r\n    ),\r\n    [showUpdates]\r\n  );\r\n\r\n  useEffectOnce(() => {\r\n    getStates();\r\n  });\r\n\r\n  useEffectOnce(() => {\r\n    axios\r\n      .get('https://api.covid19india.org/updatelog/log.json')\r\n      .then((response) => {\r\n        const lastTimestamp = response.data\r\n          .slice()\r\n          .reverse()[0]\r\n          .timestamp.toString();\r\n        if (lastTimestamp !== lastViewedLog) {\r\n          setNewUpdate(true);\r\n          setLastViewedLog(lastTimestamp);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  });\r\n\r\n  const getStates = async () => {\r\n    try {\r\n      const [\r\n        {data: statesDailyResponse},\r\n        {data: zonesResponse},\r\n      ] = await Promise.all([\r\n        axios.get('https://api.covid19india.org/states_daily.json'),\r\n        axios.get('https://api.covid19india.org/zones.json'),\r\n      ]);\r\n\r\n      const [\r\n        {data},\r\n        {data: stateDistrictWiseResponse},\r\n        {data: stateTestData},\r\n      ] = await Promise.all([\r\n        axios.get('https://api.covid19india.org/data.json'),\r\n        axios.get('https://api.covid19india.org/state_district_wise.json'),\r\n        axios.get('https://api.covid19india.org/state_test_data.json'),\r\n      ]);\r\n\r\n      setStates(data.statewise);\r\n      setDistrictZones(parseDistrictZones(zonesResponse.zones));\r\n\r\n      const ts = parseStateTimeseries(statesDailyResponse);\r\n      ts['TT'] = preprocessTimeseries(data.cases_time_series);\r\n      // Testing data timeseries\r\n      const testTs = parseStateTestTimeseries(stateTestData.states_tested_data);\r\n      testTs['TT'] = parseTotalTestTimeseries(data.tested);\r\n      // Merge\r\n      const tsMerged = mergeTimeseries(ts, testTs);\r\n      setTimeseries(tsMerged);\r\n\r\n      setLastUpdated(data.statewise[0].lastupdatedtime);\r\n\r\n      const testData = parseStateTestData(stateTestData.states_tested_data);\r\n      const totalTest = data.tested[data.tested.length - 1];\r\n      testData['Total'] = {\r\n        source: totalTest.source,\r\n        totaltested: totalTest.totalsamplestested,\r\n        updatedon: totalTest.updatetimestamp.split(' ')[0],\r\n      };\r\n      setStateTestData(testData);\r\n\r\n      setStateDistrictWiseData(stateDistrictWiseResponse);\r\n      setFetched(true);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const onHighlightState = useCallback((state) => {\r\n    if (!state) return setRegionHighlighted(null);\r\n    setRegionHighlighted({state: state.state});\r\n  }, []);\r\n\r\n  const onHighlightDistrict = useCallback((district, state) => {\r\n    if (!state && !district) return setRegionHighlighted(null);\r\n    setRegionHighlighted({district, state: state.state});\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"Home\">\r\n        <Helmet>\r\n          <title>Coronavirus Outbreak in India - covid19india.org</title>\r\n          <meta\r\n            name=\"title\"\r\n            content=\"Coronavirus Outbreak in India: Latest Map and Case Count\"\r\n          />\r\n        </Helmet>\r\n\r\n        <div className=\"home-left\">\r\n          <div className=\"header fadeInUp\" style={{animationDelay: '1s'}}>\r\n            {fetched && <Search districtZones={districtZones} />}\r\n\r\n            <div className=\"actions\">\r\n              <h5>\r\n                {isNaN(Date.parse(formatDate(lastUpdated)))\r\n                  ? ''\r\n                  : `${formatDateAbsolute(lastUpdated)} IST`}\r\n              </h5>\r\n              {fetched && !showUpdates && (\r\n                <div className=\"bell-icon\">\r\n                  {fetched && Bell}\r\n                  {newUpdate && <div className=\"indicator\"></div>}\r\n                </div>\r\n              )}\r\n              {fetched && showUpdates && BellOff}\r\n            </div>\r\n          </div>\r\n\r\n          {showUpdates && <Updates />}\r\n\r\n          {states && <Level data={states[0]} />}\r\n          {timeseries && <Minigraph timeseries={timeseries['TT']} />}\r\n          {stateDistrictWiseData && (\r\n            <Table\r\n              states={states}\r\n              summary={false}\r\n              districts={stateDistrictWiseData}\r\n              zones={districtZones}\r\n              regionHighlighted={regionHighlighted}\r\n              setRegionHighlighted={setRegionHighlighted}\r\n              onHighlightState={onHighlightState}\r\n              onHighlightDistrict={onHighlightDistrict}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"home-right\">\r\n          <React.Fragment>\r\n            {fetched && (\r\n              <MapExplorer\r\n                mapName={'India'}\r\n                states={states}\r\n                districts={stateDistrictWiseData}\r\n                zones={districtZones}\r\n                stateTestData={stateTestData}\r\n                regionHighlighted={regionHighlighted}\r\n                setRegionHighlighted={setRegionHighlighted}\r\n                anchor={anchor}\r\n                setAnchor={setAnchor}\r\n                mapOption={mapOption}\r\n                setMapOption={setMapOption}\r\n              />\r\n            )}\r\n\r\n            {timeseries && (\r\n              <TimeSeriesExplorer\r\n                timeseries={\r\n                  timeseries[\r\n                    STATE_CODES_REVERSE[regionHighlighted?.state] || 'TT'\r\n                  ]\r\n                }\r\n                activeStateCode={\r\n                  STATE_CODES_REVERSE[regionHighlighted?.state] || 'TT'\r\n                }\r\n                onHighlightState={onHighlightState}\r\n                states={states}\r\n                anchor={anchor}\r\n                setAnchor={setAnchor}\r\n              />\r\n            )}\r\n          </React.Fragment>\r\n        </div>\r\n      </div>\r\n      {fetched && <Footer />}\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n"]},"metadata":{},"sourceType":"module"}