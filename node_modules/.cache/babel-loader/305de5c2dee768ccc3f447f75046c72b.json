{"ast":null,"code":"var kd = require(\"./kd\"),\n    rad = Math.PI / 180,\n    invEarthDiameter = 1 / 12742018;\n/* meters */\n\n\nfunction spherical2cartesian(lat, lon) {\n  lat *= rad;\n  lon *= rad;\n  var cos = Math.cos(lat);\n  return [cos * Math.cos(lon), Math.sin(lat), cos * Math.sin(lon)];\n}\n\nfunction Position(object) {\n  var lat, lon;\n  /* Find latitude. */\n\n  if (object.hasOwnProperty(\"lat\")) lat = object.lat;else if (object.hasOwnProperty(\"latitude\")) lat = object.latitude;else if (object.hasOwnProperty(\"location\") && Array.isArray(object.location) && object.location.length === 2) lat = object.location[0];\n  /* Find longitude. */\n\n  if (object.hasOwnProperty(\"lon\")) lon = object.lon;else if (object.hasOwnProperty(\"longitude\")) lon = object.longitude;else if (object.hasOwnProperty(\"lng\")) lon = object.lng;else if (object.hasOwnProperty(\"long\")) lon = object.long;else if (object.hasOwnProperty(\"location\") && Array.isArray(object.location) && object.location.length === 2) lon = object.location[1];\n  /* Finally, set this object's properties. */\n\n  this.object = object;\n  this.position = spherical2cartesian(lat, lon);\n}\n\nfunction build(array) {\n  var i = array.length,\n      out = new Array(i);\n\n  while (i--) {\n    out[i] = new Position(array[i]);\n  }\n\n  return kd.build(out);\n}\n\nfunction lookup(lat, lon, node, n, max) {\n  var array = kd.lookup(spherical2cartesian(lat, lon), node, n, max > 0 ? 2 * Math.sin(max * invEarthDiameter) : undefined),\n      i = array.length;\n  /* Strip off position wrapper objects. */\n\n  while (i--) {\n    array[i] = array[i].object;\n  }\n\n  return array;\n}\n\nexports.build = build;\nexports.lookup = lookup;","map":{"version":3,"sources":["C:/Users/Jakith/JackPriyan.github.io/node_modules/sphere-knn/lib/spherekd.js"],"names":["kd","require","rad","Math","PI","invEarthDiameter","spherical2cartesian","lat","lon","cos","sin","Position","object","hasOwnProperty","latitude","Array","isArray","location","length","longitude","lng","long","position","build","array","i","out","lookup","node","n","max","undefined","exports"],"mappings":"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","sourcesContent":["var kd               = require(\"./kd\"),\n    rad              = Math.PI / 180,\n    invEarthDiameter = 1 / 12742018 /* meters */\n\nfunction spherical2cartesian(lat, lon) {\n  lat *= rad\n  lon *= rad\n  var cos = Math.cos(lat)\n  return [cos * Math.cos(lon), Math.sin(lat), cos * Math.sin(lon)]\n}\n\nfunction Position(object) {\n  var lat, lon;\n\n  /* Find latitude. */\n  if(object.hasOwnProperty(\"lat\"))\n    lat = object.lat;\n\n  else if(object.hasOwnProperty(\"latitude\"))\n    lat = object.latitude;\n\n  else if(object.hasOwnProperty(\"location\") &&\n          Array.isArray(object.location) &&\n          object.location.length === 2)\n    lat = object.location[0];\n\n  /* Find longitude. */\n  if(object.hasOwnProperty(\"lon\"))\n    lon = object.lon;\n\n  else if(object.hasOwnProperty(\"longitude\"))\n    lon = object.longitude;\n\n  else if(object.hasOwnProperty(\"lng\"))\n    lon = object.lng;\n\n  else if(object.hasOwnProperty(\"long\"))\n    lon = object.long;\n\n  else if(object.hasOwnProperty(\"location\") &&\n          Array.isArray(object.location) &&\n          object.location.length === 2)\n    lon = object.location[1];\n\n  /* Finally, set this object's properties. */\n  this.object = object;\n  this.position = spherical2cartesian(lat, lon);\n}\n\nfunction build(array) {\n  var i   = array.length,\n      out = new Array(i)\n\n  while(i--)\n    out[i] = new Position(array[i])\n\n  return kd.build(out)\n}\n\nfunction lookup(lat, lon, node, n, max) {\n  var array = kd.lookup(\n        spherical2cartesian(lat, lon),\n        node,\n        n,\n        max > 0 ? 2 * Math.sin(max * invEarthDiameter) : undefined\n      ),\n      i     = array.length\n\n  /* Strip off position wrapper objects. */\n  while(i--)\n    array[i] = array[i].object\n\n  return array\n}\n\nexports.build  = build\nexports.lookup = lookup\n"]},"metadata":{},"sourceType":"script"}